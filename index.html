<!DOCTYPE html>
<html>
  <head>
    <title>MMR OBS Overlay</title>
	<meta name="twitter:site" content="@kj_mk8dx"> 
	<style>
		@font-face {
			font-family: 'DS-FONT';
			src: url(./fonts/digital-7.ttf);
		}
		img {
			float: left;
			margin-right: 20px;
			vertical-align: middle;			
		}
		p#mmr-output {
			font-family: 'DS-FONT';
			font-size: 80px; 
			display: table-cell;
			vertical-align: middle;
			background-color: rgba(0,0,0,0.6);
		}
		p.filler {
			padding: 4px;
			margin: 0;
			color: rgba(0,0,0,0.0);
		}
		form {
			font-size: 40px;
			margin-top: 250px;
		}
		body {
			background-color: darkgray;
		}
	</style>
  	</head>
  	<body>
	<div id="output">
		<img id="mmr-rank" src="https://cdn.discordapp.com/emojis/776179743091195935.webp?size=240&quality=lossless">
		<p class="filler">Fill the text for nothing POG</p>
		<p class="mmr-output" id ="mmr-output">NULL</p>
		<p class="filler">Fill the next for nothing POG</p>
	</div>
	
	<form>
    	<label for="username">Username:</label><br>
    	<input type="text" id="username" name="username"><br>
		<input type="radio" name="color" id="standard-color" value="white" onchange="updateColor()" checked>
		
		<label for="standard-color">Standard color (white)</label><br>
		<input type="radio" name="color" id="custom-color" value="red" onchange="updateColor()">
		<label for="custom-color">Custom color</label><br>
    	<input type="button" value="Submit" onclick="getMMR()">
    </form> 
    <script>
    	function getMMR() {
			const username = encodeURIComponent(document.getElementById('username').value);
			const url = `https://api.allorigins.win/get?url=${encodeURIComponent(`https://mk8dx-lounge.com/api/player?name=${username}`)}`;
			fetch(url)
			.then(response => response.json())
			.then(data => {
				const mmr = data.mmr;
				document.getElementById('mmr-output').innerHTML = `${mmr}`;

				const Fontcolor = 'white';
				
				// Display rank icon, icon links from 150cc discord
				// Iron
				if(mmr < 2000) {
					document.getElementById('mmr-rank').src = 'https://cdn.discordapp.com/emojis/731579735544430703.webp?size=240&quality=lossless';
					Fontcolor = '#807878';
					document.getElementById('mmr-output').innerHTML.style.color='black';
				}
				// Bronze
				else if(mmr >= 2000 && mmr < 4000) {
					document.getElementById('mmr-rank').src = 'https://cdn.discordapp.com/emojis/731579759712010320.webp?size=240&quality=lossless';
					document.getElementById('mmr-output').innerHTML.style.color='yellow';
				}

				// Silver
				else if(mmr >= 4000 && mmr < 6000) {
					document.getElementById('mmr-rank').src = 'https://cdn.discordapp.com/emojis/731579781828575243.webp?size=240&quality=lossless';
					Fontcolor = '#b5b5b7';
				}
				// Gold
				else if(mmr >= 6000 && mmr < 8000) {
					document.getElementById('mmr-rank').src = 'https://cdn.discordapp.com/emojis/731579798111125594.webp?size=240&quality=lossless';
					Fontcolor = '#eab04e';
				}
				// Platin
				else if(mmr >= 8000 && mmr < 10000) {
					document.getElementById('mmr-rank').src = 'https://cdn.discordapp.com/emojis/542204444302114826.webp?size=240&quality=lossless';
					Fontcolor = '#045263';
				}
				// Sapphire
				else if(mmr >= 10000 && mmr < 12000) {
					document.getElementById('mmr-rank').src = 'https://cdn.discordapp.com/emojis/731579851802411068.webp?size=240&quality=lossless';
					Fontcolor = '#2a6cce';
				}
				// Ruby
				else if(mmr >= 12000 && mmr < 14000) {
					document.getElementById('mmr-rank').src = 'https://cdn.discordapp.com/emojis/1053874483880005663.webp?size=240&quality=lossless';
					Fontcolor = '#d31c5f';
				}
				// Diamond
				else if(mmr >= 14000 && mmr < 16000) {
					document.getElementById('mmr-rank').src = 'https://cdn.discordapp.com/emojis/731579813386780722.webp?size=240&quality=lossless';
					color = '#05a0c3';
				}
				// Master
				else if(mmr >= 16000 && mmr < 17000) {
					document.getElementById('mmr-rank').src = 'https://cdn.discordapp.com/emojis/731597294914502737.webp?size=240&quality=lossless';
					Fontcolor = '#bdccda';
				}
				// Grandmaster
				else if(mmr >= 17000) {
					document.getElementById('mmr-rank').src = 'https://cdn.discordapp.com/emojis/731579876846338161.webp?size=240&quality=lossless';
					Fontcolor = '#830c2c';
				}
				else {
					document.getElementById('mmr-rank').src = "https://cdn.discordapp.com/emojis/776179743091195935.webp?size=240&quality=lossless";
					Fontcolor = 'white';
				}
			});
			if (document.getElementById('custom-color').checked) {
				document.getElementById('mmr-output').style.color = Fontcolor;
			} else {
				document.getElementById('mmr-output').style.color = 'white';
			}

		}
    	</script>
  	</body>
</html>